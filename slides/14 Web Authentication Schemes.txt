Web Authentication Schemes
MelinaHoffmann
hoffmann@cs.uni-bonn.de
UniversityofBonn|InstituteofComputerScience4
LectureITSecurity| UniBonn| WT2025/26
About Me
2023MasterComputerScienceinBonn
since2023ResearcherWGIT-Security
Project„DARIA“
collaborativeandprivacypreservingfraudprevention
onlineidentitiesandauthentication
Project„PEKI“
1
Contents
Whydoweneeddifferentwebauthenticationschemes?
GermaneID
FIDO2
BrowserFingerprinting
RiskBasedAuthentication
Conclusion
2
Why do we need different web authentication
schemes?
Motivation: Classic Username and Pass-
word Schemes
Historically,webapplicationstypicallyuseanauthenticationschemethatisbasedon
ausernameandpasswordcombination.Theuserchoosesusernameandpasswordon
registration.Thecredentialsarestoredbytheonlineserviceandshouldbesecurely
hashedandsalted.Duringaloginattempt,thestoredcredentialsarecomparedtothe
userinput.
Disadvantagesandsecurityrisks:
Usersneedstoremembercredentialsforallonlineservices
Passwordsmaybeweakandeasytoguessorreused
Usersmayneedtoentertheirpersonaldatamultipletimes
Onlineservicemayuseweaksecuritymeasureswhenstoringthecredentials
3
German eID
German Electronic Identity (Online-
Ausweis)
introducedin2010
chipongermanidentitydocuments,e.g.identitycard,passport,
residencepermit
storespersonaldataoftheholder,analogoustotheprintedinfor-
mationonthedocument
canbeusedforonlineidentificationandauthentication
https://www.personalauswei
sportal.de/Webs/PA/DE/buer
gerinnen-und-buerger/onlin
e-ausweisen/online-ausweis
en-node.html
4
Typical Use Cases
onlineidentificationandauthentificationlinkedtoastateissuedandverifiedoffline
identity
officialadministrationservices
privatecompaniesthatrequirestrongauthenticationoftheircustomersfor
legitimizingcertaintransactions
canalsogenerateapseudonymwhichcanbeusedtorecognizeandreidentifycus-
tomersoruserswithoutlearninganyoftheiractualpersonaldata
5
German eID
Components
User Environment
identitydocument
storespersonaldataofthecardholderanalogoustotheprintedinformation
onthedocument,e.g.name,dateofbirth,expirydate,nationality
storeseIDsystemspecificdata,e.g.cryptographickeysusedintheauthenti-
cationprocess
cardreader
e.g.dedicatedreaderdeviceorNFC-compliantsmartphone
6-digitPIN
eIDclient
softwareonlocaldevice
managesauthenticationprocessontheclientsideandcommunicatesbetween
theuser,cardreaderandeIDservice
e.g.AusweisAppbyGovernikus
6
eID Service
onlineservicethatusestheonlineauthenticationviaeID
canrequestonlyuserandservicespecificpseudonymforuserreidentification
simpleimplementationviaofficialloginpluginsforwordpress,nextcloudand
TYPO3
iftheeIDservicewantstorequestpersonaldata,infrastructureandofficialcertifi-
cationisrequired
7
eID Service
Processforcertification
serviceconceptincludinglistofrequireddatafieldsthatshouldbereadfromthe
eID
stateissuedauthorizationcertificate
officialpaperworkpermittingtheoperationofaneIDservice
vettingthedeclarationondataprotectionanddatasecurityaswellasthene-
cessityoftherequestedpersonaldatafields
technicalauthorizationcertificate
electroniccertificate
i.a.specifieswhichdatafieldsareallowedtoberequestedbytheservice
requirement:stateissuedauthorizationcertificate
8
eID Server
hard-andsoftware-componentoftheeIDserviceinfrastructure
undertakessecurecommunicationbetweeneIDclient,idcardchip,eIDservice
alsocommunicateswithcentralbackendstructures
9
German eID
OnlineAuthenticationProcess
Online Authentication Process
1 uservisitstheeIDservice’swebsiterequiringonlineauthentication
2 theeIDservicesendsanauthenticationrequesttotheeIDserverandactivatesthe
eIDclientviatheuser’sapplication
3 GeneralAuthenticationProcedurebetweeneIDserver,eIDclientandthechipon
theuser’sdocument
10
General Authentication Procedure
11
PACE
PasswordAuthenticatedConnectionEstablishment
verifiesthatuserhasknowledgeofthePINcorrespondingtothepresentedeIDcard
mutualauthenticationbetweeneIDclientandthechip
12
Extended Access Control v2
mutualauthenticationofeIDserviceandtheeIDdocumentviatheeIDserverandeID
client
AuthenticationoftheeIDservice(TerminalAuthenticationVersion2)
proofofauthenticityandaccessrights(requireddatafields)oftheeIDservice
usestheeIDservicestechnicalauthorizationcerfiticateandthereforerequires
theeIDservertocommunicationwiththeauthorizationPKI
AuthenticationoftheGermaneID’spublickey(PassiveAuthentication)
usesadigitalsignaturefromthecardmanufacturertoauthenticatethedata
storedonthechip
eIDservercommunicationwiththedocumentPKI
partofthestoredandauthenticateddata:staticpublickeyofthechipusedin
thenextstep
13
Extended Access Control v2
Authenticationofthedocument(ChipAuthenticationVersion2)
Diffie-Hellmanbasedprotocoltofurtherauthenticatethechip
verificationthatthechipcontainstheprivatekeythatcorrespondstothever-
ifiedpublickeyfromthepreviousstep
14
Online Authentication Process
1 uservisitstheeIDservice’swebsiterequiringonlineauthentication
2 theeIDservicesendsanauthenticationrequesttotheeIDserverandactivatesthe
eIDclientviatheuser’sapplication
3 GeneralAuthenticationProcedure
4 eIDservertransmitstheresultandpersonaldatatotheeIDserviceandredirects
theeIDclientbacktothewebsession
5 eIDservicecheckstheresponseand,ifsatisfactory,grantsaccesstotheuser
15
German eID
Revocation
Revocation
TheeIDsystemneedsanoptiontorevokeastolenorlostidentificationdocument.
Thecardholdertypicallyissuesthenotificationthroughtheissuingauthority,thepo-
liceorarevocationhotline,whichthenneedstomakethisinformationelectronically
availableintheeIDsystem.
Complication: servicespecificpseudonyms
Ifthereisaglobalrevocationlistthatusescardserialnumbersorthatallowslinking
toonerevocationentrywithallservicespecificpseudonyms,thepseudonymityislost.
Solution: eIDservicespecificrevocationlistsandrevocationservicetomanagethese
lists
16
Preparations
Preparationsduringidentitycardmanufacturing
revocationkey
public/privatekeypair
publickeysendtorevocationservice
privatepartstoredonthechip
revocationpassword
cleartextpassword,randomlychosenfromawordlist
sendtothecardholderwiththePINinthePINletter
sendtoresidentregister
revocationcode
hashoverthefirstname,lastname,birthdateandrevocationpassword
sendtotheresidentregister
sendtotherevocationservice
17
Preparations
PreparationsoftherevocationserviceandeIDservice
revocationsector
keypairoftherevocationservice
privatekeyusedto„activate“therevocationkeyofanidcard
publickeybasepointforthegenerationoftheterminalsectors
terminalsector
keypairspecifictooneeIDserviceandonerevocationservice
generatedbytheauthorizationCAbasedontherevocationsector
publickeypartoftheauthorizationcertificateoftheeIDservice
privatepartusedbyauthorizationCAtoconvert„activated“revocationkeysto
eIDservicespecificrevocationtokens
18
Revocation Process
Userrevokesanindentificationdocument
1 usernotifiestheauthoritiesorthehotline
2 authority/hotlinegeneratestherevocationcodefromtheuserspersonalinforma-
tionandrevocationpasswordfromthePINletter,orlooksitupintheresidentreg-
ister
3 revocationcodeissendtotherevocationservice
4 revocationservicelooksupthecorrespondingrevocationkeyandmakesanentry
intherevocationlist
19
Revocation Process
eIDservicespecificrevocationlistisgeneratedfromthecardspecificrevocationkeys
1 therevocationserviceusesitsownprivatekeyfromtherevocationsectortoconvert
thecardspecificrevocationkeyintoan„activated“revocationkey
2 theauthorizationCAsretrievethelistof„activated“revocationkeys
3 theauthorizationCAsconvertthelistsof„activated“revocationkeystoservice-
specificlistsofrevocationtokensusingtheprivatepartoftheeIDservicespecific
terminalsector
4 eIDserversorserviceprovidersretrievethelistsofeIDservicespecificrevocation
tokensfromtheirauthorizationCA
20
Revocation Process
Futureauthenticationattemptswiththelostorstolendocument
1 duringtheonlineauthenticationprocess,thechipgeneratestheeIDservicespecific
revocationtokenfromitsownprivatepartoftherevocationkeyandthepublicpart
oftheeIDservicespecificrevocationsector
2 chipandeIDservicespecificrevocationtokenischeckedagainsttheeIDservice
specificlistofrevocationtokens
Therevocationprocesscanbereversedandtherevocationstatuscanberetrievedvia
theissuingauthority.
21
German eID
UsageandLimitations
Limitations
linkedtoandrequiresstateissueddocumentsandidentities
complexsetup,includingcertificationprocess
complexsystemwithalotofcomponentsandbackgroundinfrastructurethatneeds
toberunbytrustedparties
asoftodayseenasquitesecure,althoughnotentirelywithoutrisksorattacksvec-
tors
22
Usage
42%percentofcitizenshavetheeIDPINactivated
25%haveusedtheeIDfunctionalitybefore
Personalausweisportallistsover250eIDservices,includingvariousmunicipalities
andgovermentservicesaswellasprivatecompanies
notlimitedtogermancitizens,thankstotheeIDASschemeandthegermaneIDcard
forcitizensoftheEUandtheEEA
https://initiatived21.de/uploads/03_Studien-Publikationen/eGovernment-MONITOR/2025/eGovMon2025_final.pdf
https://www.personalausweisportal.de/SiteGlobals/Forms/Webs/PA/suche/anwendungensuche-formular.html?gts=14626016_list%253DunifiedDate_dt
%2Bdesc&gtp=14626016_list%253D2
23
FIDO2
FIDO2
FIDO2isanauthenticationstandardspecifiedbytheW3C(WorldWideWebConsor-
tium)andFIDOAlliance(FastIDentityOnline).
Goal: replacepassword-basedschemesoraugmentthemwithpublickeycryptogra-
phybasedauthenticationthatis
moresecurethanpasswords
simpletouse
simpletodeployandmanage
24
Components
Authenticator
hardwarebasedtokenthatgeneratesandstoresprivate-publickeypairs
clientdevicewithinternalFIDO2authenticator,dedicatedexternalhardwareorsoft-
ware
RelyingParty
serviceusingFIDO2authentication,containingawebapplicationandFIDO2server
Client
bridgebetweenauthenticatorandrelyingparty,typicallytheuserswebbrowseror
operatingsystemsubsystem
CommunicationProtocols
CTAP(ClienttoAuthenticatorProtocol)forcommunicationbetweenclientandau-
thenticator
WebAuthnbetweenclientandrelyingparty
25
FIDO2
RegistrationandAuthentication
User Registration
Relying Party Server
6
server validation
PublicKeyCredentialCreationOptions
challenge,
user info,
relying party info
1
0
5
clientDataJSON,
attestationObject
AuthenticatorAttestationResponse
RP JavaScript Application
Browser
relying party id ,
user info,
relying party info,
clientDataHash
2
4
new public key,
credential id,
attestation
attestationObject
Authenticator
3
user verification,
new keypair,
attestation
https://developers.yubico.com/WebAuthn/WebAuthn_Developer_Guide/WebAuthn_Client_Registration.html
26
User (Re-)Authentication
Relying Party Server
6
server validation
PublicKeyCredentialRequestOptions
challenge
1
0
5
clientDataJSON,
authenticatorData,
signature
AuthenticatorAssertionResponse
RP JavaScript Application
WebAuthnAPI
Browser
relying party id,
clientDataHash
2
4
authenticatorData
signature
Authenticator
3
user verification,
create assertion
https://developers.yubico.com/WebAuthn/WebAuthn_Developer_Guide/WebAuthn_Client_Authentication.html
27
FIDO2
UsageandLimitations
Usage and Limitations
inthebasicversion,thecredentialsaretiedtoasingleauthenticatordevice
morecomplexsetupthansimplepasswordbasedscheme
needsadditionalbackgroundinfrastructure
somepossibleattacks,e.g.MitMduringregistration
usedbynumerouscompaniesandservices,e.g.discord,dropbox,ebay,facebook,
github,UniversityofBonn
28
Browser Fingerprinting
Browser Fingerprinting
„ Abrowserfingerprintisasetofinformationrelatedtoauser’sdevicefrom
thehardwaretotheoperatingsystemtothebrowseranditsconfiguration. “
„ Browser fingerprinting refers to the process of collecting information
throughawebbrowsertobuildafingerprintofadevice. “
BrowserFingerprinting:ASurvey-Laperdrixetal.-2020
29
Browser Fingerprinting
UserAgent
HTTP User-Agent Request Header
requestheader:HTTPheaderthatcanbeusedinanHTTPrequesttoprovideinfor-
mationsothattheservercantailortheresponse
HTTPUser-Agentrequestheaderisacharacteristicstringthatletsserversidentify
theapplication,operatingsystem,vendor,and/orversionoftherequestinguser
agent
originallymeanttopreventincompatibilityproblems
Generalsyntax:
User-Agent: <product>/<product-version><comment>
30
Example: Firefox
Commonformatforwebbrowsers:
Mozilla/5.0 (<system-information>) <platform>(<platform-details>)
<extensions>
ExampleforFirefox:
Mozilla/5.0 (Windows NT 6.1; Win64; x64; rv:47.0)
Gecko/20100101 Firefox/47.0
31
Browser Fingerprinting
AdditionalFeatures
Additional Features Used for Browser
Fingerprinting
Examplesoffurtherattributes:
contentlanguageasspecifiedinHTTPheader
listofinstalledplugins
timezone
screenresolutionandcolourdepth
useofanadblocker
canvas
32
Example: Canvas Fingerprinting
TheCanvasAPIcanbeusedtodrawandmanipulategraphicsviaJavaScriptandthe
HTML<canvas>element.Thefinaluser-visiblebitmapisinfluencedbyoperatingsys-
tem,browserversion,graphicscard,installedfontsandmore. Therefore,different
devicesrenderthesamecanvasdrawingasdefinedinHTMLandJavaScriptslightly
differently.
CanvasFingerprinting:
renderinvisiblepictureintheusersbrowser
collectthecharacteristicrenderingaspartofthefingerprint
33
Example: Canvas Fingerprinting
https://amiunique.org
34
Browser Fingerprinting
UsageandLimitations
Usage and Limitations
notanactualpreciseauthenticationmethod
usageinstudyresultsvariesbyanorderofmagnitudedependingonthemethod
anddefinitionoffingerprinting
usedinliteratureandcompaniesforfrauddetectionandpreventionbysearching
foranomaliesinuserbehaviourpatterns
35
Risk Based Authentication
Risk Based Authentication
RBA(RiskBasedAuthentication)isanadaptivesecuritymeasuretostrengthenpassword-
basedauthentication.WithRBA,anonlineservicemonitorsadditionalfeaturesduring
passwordentrytoassestheriskofidentitytheft.Ifacertainrisklevelisdetected,ad-
ditionalauthenticationfactorsarerequested. ThegoalofRBAistoeffectivelyand
efficientlycombinedifferentconcreteauthenticationschemes.
36
Risk Based Authentication
LoginProcess
Login Process
Attackermodel: knowsthecorrectcredentialsorcanguessthemwithalownumber
oftries
Duringloginprocess:
1 duringpasswordentry,additionalfeaturesarebeingmonitoredinthebackground
2 fromthesefeatures,theservicecalculatesariskscore
3 dependingontheriskscore,differentadditionalauthenticationmeasuresarere-
quired
e.g.nonewhenscorelow,additionalauthenticationfactorwhenmedium(e.g.
e-mailverification,SMSverification),blockaccesswhenhigh
37
Risk Based Authentication
UsageandLimitations
Usage Study
„IsThisReallyYou? AnEmpiricalStudyonRisk-BasedAuthenticationAppliedinthe
Wild“-Wieflingetal.2019
investigated8onlineservices:Amazon,Facebook,GOG.com,Google,iCloud,LinkedIn,
SteamandTwitch
usedvirtualidentitiesanduseraccountsandsimulated„typical“userbehaviour
thenchangedfeaturesfromtheassumedRBAfeaturelistandrecordedthebe-
haviouroftheonlineservices
featurelist: IPaddress,useragentstring,language,displayresolution,login
time
38
Study Results Example: Google
FeaturesUsedinRBA:
eitherIPaddress,useragentorscreenresolutionchanged:e-mailsecurityalert
strongvariationinIPaddress:requestforadditionalauthenticationfactor
allcombinationsof2factorsexceptlanguage+time:e-mailsecurityalert
threefeatureschanged:securityalert
IPaddress,useragent,andtimeparameters:additionalauthenticationfactor
Additionalauthenticatonfactors:
enternameofcityyouusuallysigninfrom
verificationcodeovervariouschannels,e.g.email,app,textmessage
pressconfirmationbuttononsecondarydevice
39
Study Results Summary
usedparameters,riskthreshold(s)andtriggeredactionsvarysignificantlybetween
services,includingnodetectedRBAforsomeservices
alldiscoveredfeaturesetscontainIPaddress
alldiscoveredRBAschemesusverificationcodesofsomekindasanadditionalau-
thenticationfactor
40
Limitations
notastandardizedauthenticationschemeinandofitself
securitydependsontheutilisedfingerprintingandauthenticationmethods
riskofinconveniencinglegitimateusersthatjusthappentodeviatefromtheirusual
behavioralpatterns
mightaddsecurityandprivacyrisks,e.g.byleakinglegitimateuser’sdata
41
Conclusion
Conclusion
overviewoverdifferentwebauthenticationschemesfordifferentneedsandsce-
narios
balancebetweendifferentfactorslikesecurityrequirements,userexperience,ease
ofinstallationandmaintenancedeterminethebestsetupforaspecificservice
42
Thank you for your attention!
Questions?
Melina Hoffmann
University of Bonn | Institute of Computer Science 4
hoffmann@cs.uni-bonn.de